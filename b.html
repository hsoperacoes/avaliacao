<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Feedback da Integração</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet"/>

  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    body{font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;line-height:1.6;color:#eaeaea;background:#1a1a1a;min-height:100vh;padding:20px 0}
    .container{max-width:1200px;margin:0 auto;padding:0 20px}

    .header{background:linear-gradient(135deg,#2c3e50 0%,#34495e 100%);color:#fff;padding:40px 30px;text-align:center;border-radius:15px 15px 0 0;box-shadow:0 4px 20px rgba(0,0,0,.3);position:relative;overflow:hidden}
    .header::before{content:'';position:absolute;top:-50%;left:-50%;width:200%;height:200%;background:radial-gradient(circle,rgba(255,255,255,.06) 0%,transparent 70%);animation:rotate 30s linear infinite}
    @keyframes rotate{from{transform:rotate(0)}to{transform:rotate(360deg)}}
    .header-content{position:relative;z-index:1}
    .header-icon{font-size:3em;margin-bottom:16px;color:#4CAF50}
    .header h1{font-size:2.1em;font-weight:800;margin-bottom:6px}
    .header h2{font-size:1.15em;font-weight:500;opacity:.95}

    .main{background:#2a2a2a;border-radius:0 0 15px 15px;box-shadow:0 4px 20px rgba(0,0,0,.3);padding:28px}
    .card{background:#3a3a3a;border-radius:12px;padding:22px;margin-bottom:22px;box-shadow:0 4px 15px rgba(0,0,0,.2)}
    .card h3{display:flex;align-items:center;gap:10px;margin-bottom:12px;color:#fff}
    .badge{padding:4px 10px;border-radius:999px;font-size:.78rem;background:#424242;color:#e0e0e0}

    .grid{display:grid;grid-template-columns:repeat(12,1fr);gap:14px}
    .col-12{grid-column:span 12}
    .col-6{grid-column:span 6}
    .col-4{grid-column:span 4}

    label{display:block;color:#eaeaea;font-weight:700;margin-bottom:6px}
    input[type="text"],input[type="email"],input[type="date"],textarea,select{
      width:100%;background:#4a4a4a;border:2px solid #555;border-radius:10px;padding:11px 12px;color:#fff;transition:.2s
    }
    textarea{min-height:90px;resize:vertical}
    input:read-only{opacity:.85}
    input:focus,textarea:focus,select:focus{outline:none;border-color:#4CAF50;box-shadow:0 0 0 3px rgba(76,175,80,.2);background:#565656}

    .q{background:#444;border:2px solid #555;border-radius:10px;padding:14px}
    .q + .q{margin-top:12px}
    .q p{font-weight:600;color:#a5e8b1;margin-bottom:8px}
    .inline{display:flex;gap:10px;flex-wrap:wrap}
    .opt{background:#4a4a4a;border:2px solid #666;border-radius:10px;padding:8px 12px;display:inline-flex;align-items:center;gap:8px;cursor:pointer}
    .opt input{display:none}
    .dot{width:16px;height:16px;border:2px solid #888;border-radius:50%}
    .opt input:checked + .dot{background:#4CAF50;border-color:#4CAF50}

    .actions{display:flex;gap:14px;justify-content:center;margin-top:18px;padding-top:16px;border-top:2px solid #555;flex-wrap:wrap}
    .btn{display:inline-flex;align-items:center;gap:10px;padding:12px 20px;border:none;border-radius:10px;font-weight:800;cursor:pointer;text-transform:uppercase}
    .btn-primary{background:linear-gradient(135deg,#4CAF50 0%,#45a049 100%);color:#fff}
    .btn-secondary{background:linear-gradient(135deg,#2196F3 0%,#1976D2 100%);color:#fff}

    .ok{display:none;background:#2e7d32;color:#fff;border-radius:10px;padding:14px;text-align:center;margin-bottom:14px}
    .err{display:none;background:#b71c1c;color:#fff;border-radius:10px;padding:14px;text-align:center;margin-bottom:14px}

    @media(max-width:820px){.col-6{grid-column:span 12}.col-4{grid-column:span 12}}
  </style>
</head>
<body>
  <div class="container">
    <header class="header">
      <div class="header-content">
        <i class="fas fa-comments header-icon"></i>
        <h1>FEEDBACK DA INTEGRAÇÃO</h1>
        <h2>Conte pra gente como foi sua experiência na loja</h2>
      </div>
    </header>

    <main class="main">
      <div id="ok" class="ok"><i class="fas fa-check-circle"></i> Feedback enviado. Obrigado!</div>
      <div id="err" class="err"><i class="fas fa-triangle-exclamation"></i> Não foi possível enviar. Tente novamente.</div>

      <!-- Dados do colaborador -->
      <section class="card">
        <h3><i class="fas fa-id-badge"></i> Seus dados <span class="badge">preenchidos automaticamente</span></h3>
        <div class="grid">
          <div class="col-6">
            <label>Nome</label>
            <input id="employeeName" type="text" readonly>
          </div>
          <div class="col-6">
            <label>E-mail</label>
            <input id="email" type="email" readonly>
          </div>
          <div class="col-4">
            <label>Cargo</label>
            <input id="position" type="text" readonly>
          </div>
          <div class="col-4">
            <label>Data de Início</label>
            <input id="startDate" type="text" readonly>
          </div>
          <div class="col-4">
            <label>Gerente</label>
            <input id="manager" type="text" readonly>
          </div>
          <input id="employeeId" type="hidden">
        </div>
      </section>

      <!-- Perguntas -->
      <section class="card">
        <h3><i class="fas fa-list-check"></i> Questionário</h3>

        <form id="fbForm">
          <!-- 1 -->
          <div class="q">
            <p>1) Ficou claro quais serão suas tarefas?</p>
            <div class="inline">
              <label class="opt"><input type="radio" name="q1" value="Sim"><span class="dot"></span>Sim</label>
              <label class="opt"><input type="radio" name="q1" value="Parcialmente"><span class="dot"></span>Parcialmente</label>
              <label class="opt"><input type="radio" name="q1" value="Não"><span class="dot"></span>Não</label>
            </div>
          </div>

          <div class="q"><p>2) Quem mais te ajudou no processo?</p><input type="text" name="q2"></div>

          <div class="q">
            <p>3) Quanto você se sente seguro(a) para atuar na área solicitada? (0 a 10)</p>
            <input type="number" name="q3" min="0" max="10" step="1" placeholder="0–10">
          </div>

          <div class="q"><p>4) O que você achou mais difícil e mais fácil?</p><textarea name="q4"></textarea></div>

          <div class="q">
            <p>5) O direcionamento da gerência acontece com que frequência na sua percepção?</p>
            <div class="inline">
              <label class="opt"><input type="radio" name="q5" value="Sempre"><span class="dot"></span>Sempre</label>
              <label class="opt"><input type="radio" name="q5" value="Às vezes"><span class="dot"></span>Às vezes</label>
              <label class="opt"><input type="radio" name="q5" value="Nunca"><span class="dot"></span>Nunca</label>
            </div>
          </div>

          <div class="q"><p>6) Você se sente parte da equipe após a integração? Justifique</p><textarea name="q6"></textarea></div>

          <div class="q"><p>7) Foi lhe apresentado todas as ferramentas e sistemas da empresa que estarão a sua disposição? Se sim, qual te chamou mais atenção?</p><textarea name="q7"></textarea></div>

          <div class="q"><p>8) Foi lhe apresentado o estoque?</p><input type="text" name="q8"></div>

          <div class="q"><p>9) Foi lhe apresentada a área de vendas? (dobras, divisões de setores etc.)</p><textarea name="q9"></textarea></div>

          <div class="q"><p>10) Como foi seu primeiro dia de vendas?</p><textarea name="q10"></textarea></div>

          <div class="q"><p>11) Você acha que teve um bom acompanhamento e auxílio durante seus atendimentos?</p><textarea name="q11"></textarea></div>

          <div class="q"><p>12) Dê uma sugestão para melhorarmos a integração.</p><textarea name="q12"></textarea></div>

          <div class="actions">
            <button class="btn btn-primary" type="submit"><i class="fas fa-paper-plane"></i> Enviar feedback</button>
            <a class="btn btn-secondary" href="home.html"><i class="fas fa-home"></i> Home</a>
          </div>
        </form>
      </section>
    </main>
  </div>

  <script>
    // === CONFIG ===
    const GAS = 'https://script.google.com/macros/s/AKfycbzx7fZB5WPpdAI7nUADWhzWZF83CyTKIl50jkOeJanoPao9t1eecOQ5CrshZksO5A5e/exec'; // coloque a URL do seu Web App

    function qs(k){ return new URLSearchParams(location.search).get(k) || ''; }
    function setVal(id,v){ const el=document.getElementById(id); if(el) el.value=v||''; }

    async function prefill(){
      const q=qs('q'), token=qs('token');
      if(!q||!token) return; // opcional: bloquear sem token
      try{
        const r = await fetch(`${GAS}?view=feedback&q=${encodeURIComponent(q)}&token=${encodeURIComponent(token)}`,{cache:'no-store'});
        const out = await r.json();
        if(!out.ok || !out.record){ document.getElementById('err').style.display='block'; return; }
        const d=out.record;
        setVal('employeeId', d.employeeId);
        setVal('employeeName', d.name);
        setVal('email', d.email);
        setVal('position', d.position);
        setVal('startDate', d.startDate);
        setVal('manager', d.manager);
      }catch(e){ document.getElementById('err').style.display='block'; }
    }

    document.getElementById('fbForm').addEventListener('submit', async (ev)=>{
      ev.preventDefault();
      const fd = new FormData(ev.target);
      const payload = { 
        type:'feedback-submit',
        employeeId: document.getElementById('employeeId').value,
        name:       document.getElementById('employeeName').value,
        email:      document.getElementById('email').value,
        position:   document.getElementById('position').value,
        startDate:  document.getElementById('startDate').value,
        manager:    document.getElementById('manager').value,
        answers: Object.fromEntries(fd.entries()) // q1..q12
      };
      try{
        const res = await fetch(GAS, { method:'POST', headers:{'Content-Type':'text/plain'}, body: JSON.stringify(payload) });
        const out = await res.json();
        if(out.ok){ document.getElementById('ok').style.display='block'; window.scrollTo({top:0,behavior:'smooth'}); ev.target.reset(); }
        else{ document.getElementById('err').style.display='block'; }
      }catch(_){ document.getElementById('err').style.display='block'; }
    });

    document.addEventListener('DOMContentLoaded', prefill);
  </script>
</body>
</html>
